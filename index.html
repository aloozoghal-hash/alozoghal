<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ùˆ Ø°ØºØ§Ù„ | Ø³ÙØ§Ø±Ø´ Ø¢Ù†Ù„Ø§ÛŒÙ†</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#050505">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <link rel="icon" href="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/8f6dcedf3dc3dbaa82c0df548bd962c9.jpg">

    <style>
        @import url('https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css');
        :root { --fire: #ff4d00; --gold: #e2b04a; --bg: #050505; --royal: #ffd700; --tg: #0088cc; --sms: #ff5722; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Vazirmatn', sans-serif; }

        body {
            background: var(--bg); color: #fff; min-height: 100vh; padding: 15px;
            background-image: radial-gradient(circle at 50% 0%, #3a1100 0%, #050505 80%);
            display: flex; flex-direction: column; align-items: center; padding-bottom: 50px;
        }

        #pwa-install-banner {
            display: none; position: fixed; bottom: 90px; left: 15px; right: 15px;
            background: rgba(20, 20, 20, 0.95); border: 1px solid var(--gold);
            border-radius: 20px; padding: 12px; z-index: 2000; backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(226, 176, 74, 0.4); animation: slideUp 0.5s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .banner-content { display: flex; align-items: center; gap: 12px; }
        .banner-logo { width: 45px; height: 45px; border-radius: 10px; border: 1px solid var(--gold); }
        .banner-text { flex: 1; font-size: 12px; color: #fff; text-align: right; }
        .btn-install-now { background: var(--gold); color: #000; border: none; padding: 8px 12px; border-radius: 8px; font-weight: bold; cursor: pointer; }

        .header-section { text-align: center; margin-bottom: 20px; }
        .main-logo { width: 85px; height: 85px; border-radius: 50%; border: 2px solid var(--gold); object-fit: cover; box-shadow: 0 0 15px rgba(226, 176, 74, 0.4); }
        
        .brand-container { display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 8px; }
        .brand-name { font-size: 26px; font-weight: 900; color: var(--gold); }
        
        .fire-anim { display: inline-block; animation: heatPulse 1.5s infinite alternate; filter: drop-shadow(0 0 2px #ff4d00); font-size: 24px; }
        @keyframes heatPulse {
            0% { transform: scale(1); filter: drop-shadow(0 0 2px #ff4d00) brightness(1); }
            100% { transform: scale(1.15) rotate(-3deg); filter: drop-shadow(0 0 12px #ffae00) brightness(1.3); }
        }

        .sub-brand { 
            font-size: 18px; 
            font-weight: 900; 
            color: var(--royal); 
            margin-top: 8px; 
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
            animation: softBlink 1s infinite alternate; 
        }
        @keyframes softBlink { from { opacity: 1; } to { opacity: 0.3; } }

        .btn-share-modern {
            width: 100%;
            padding: 14px;
            background: linear-gradient(45deg, #1a1a1a, #2c2c2c);
            border: 1px solid rgba(226, 176, 74, 0.3);
            border-radius: 18px;
            color: #fff;
            font-weight: bold;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-top: 25px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            transition: 0.3s;
        }
        .btn-share-modern:active { transform: scale(0.95); }
        .share-dot { width: 8px; height: 8px; background: var(--gold); border-radius: 50%; animation: pulseGold 1.5s infinite; }
        @keyframes pulseGold { 0% { box-shadow: 0 0 0 0 rgba(226, 176, 74, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(226, 176, 74, 0); } 100% { box-shadow: 0 0 0 0 rgba(226, 176, 74, 0); } }

        .challenge-link {
            display: block; margin: 15px 0; padding: 10px; text-decoration: none; color: #fff; background: rgba(255, 215, 0, 0.1);
            border: 1px dashed var(--gold); border-radius: 12px; font-weight: bold; font-size: 14px; animation: blinkChallenge 1.5s infinite; transition: 0.3s; text-align: center;
        }
        @keyframes blinkChallenge {
            0%, 100% { opacity: 1; transform: scale(1); box-shadow: 0 0 5px var(--gold); }
            50% { opacity: 0.7; transform: scale(0.98); box-shadow: 0 0 15px var(--fire); }
        }

        .media-container { width: 100%; max-width: 420px; border-radius: 20px; overflow: hidden; border: 1px solid rgba(226, 176, 74, 0.4); margin-bottom: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); background: #000; }
        .video-slider { position: relative; width: 100%; aspect-ratio: 16/9; overflow: hidden; }
        .video-wrapper { display: flex; transition: transform 0.6s ease-in-out; height: 100%; }
        .video-wrapper video { width: 100%; flex-shrink: 0; object-fit: cover; }
        .nav-btn { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.5); border: none; color: #fff; width: 40px; height: 40px; cursor: pointer; border-radius: 50%; z-index: 10; font-size: 20px; display: flex; align-items: center; justify-content: center; }
        .prev-btn { left: 10px; } .next-btn { right: 10px; }
        .mute-toggle { position: absolute; bottom: 10px; left: 10px; z-index: 10; background: var(--gold); border: none; width: 35px; height: 35px; border-radius: 50%; color: #000; cursor: pointer; }
        .image-fader { position: relative; width: 100%; aspect-ratio: 16/9; border-top: 2px solid #222; }
        .image-fader img { position: absolute; width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 1s; left: 0; top: 0; }
        .image-fader img.active { opacity: 1; }
        .reviews-container { width: 100%; max-width: 420px; background: rgba(226, 176, 74, 0.05); border: 1px solid rgba(226, 176, 74, 0.2); border-radius: 20px; padding: 15px; margin-bottom: 20px; min-height: 95px; text-align: center; }
        #comment-content { transition: opacity 0.6s; font-size: 14px; line-height: 1.6; }
        .c-name { color: var(--gold); font-weight: bold; display: block; margin-bottom: 4px; }
        .order-card { width: 100%; max-width: 420px; background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(15px); border-radius: 30px; border: 1px solid rgba(255, 255, 255, 0.1); padding: 25px; }
        .form-group { margin-bottom: 15px; text-align: right; }
        label { display: block; margin-bottom: 6px; color: #bbb; font-size: 13px; }
        input, textarea, select { width: 100%; padding: 14px; background: rgba(0,0,0,0.5); border: 1px solid #333; border-radius: 12px; color: #fff; text-align: right; font-size: 16px; outline: none; }
        .qty-box { display: flex; align-items: center; justify-content: space-between; background: #000; border-radius: 12px; padding: 5px; border: 1px solid #333; direction: ltr; margin-bottom: 10px; }
        .qty-btn { width: 45px; height: 45px; border-radius: 10px; border: none; background: #1a1a1a; color: var(--gold); font-size: 24px; cursor: pointer; }
        .btn { width: 100%; padding: 16px; border: none; border-radius: 15px; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 16px; display: block; text-decoration: none; text-align: center; }
        .btn-gold { background: linear-gradient(135deg, var(--gold), #b8860b); color: #000; }
        .btn-gps { background: transparent; color: #fff; border: 1px solid #555; font-size: 13px; }
        .btn-wa { background: #25D366; color: #fff; display: none; }
        .btn-tg { background: var(--tg); color: #fff; display: none; }
        .btn-sms { background: var(--sms); color: #fff; display: none; }
        .btn-action { display: flex; gap: 10px; }
        .btn-edit { background: #444; color: #fff; }
        .btn-reset { background: #8b0000; color: #fff; }
        .invoice-card { display: none; background: #1a1a1a; border: 3px double var(--gold); border-radius: 20px; padding: 20px; margin-top: 15px; text-align: center; }
        .invoice-row { display: flex; justify-content: space-between; margin-bottom: 8px; border-bottom: 1px dotted #444; padding-bottom: 4px; font-size: 14px; }
        .stars { display: flex; justify-content: center; gap: 8px; margin-bottom: 15px; direction: ltr; }
        .star { font-size: 32px; cursor: pointer; color: #333; transition: 0.3s; }
        .star.active { color: var(--gold); text-shadow: 0 0 10px rgba(226, 176, 74, 0.5); }
        .review-item { background: rgba(255,255,255,0.03); padding: 12px; border-radius: 15px; margin-bottom: 10px; border-right: 4px solid var(--gold); text-align: right; }
        .star-display { color: var(--gold); font-size: 12px; margin-left: 5px; letter-spacing: 2px; }

        .loyalty-info { font-size: 11px; color: var(--gold); margin-top: 4px; display: block; }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ù‚Ù„Ú© Ø¬Ø¯ÛŒØ¯ */
        .wallet-container { background: #111; border: 1px solid #333; border-radius: 15px; padding: 10px; margin-bottom: 15px; }
        .wallet-bar-bg { background: #222; height: 10px; border-radius: 5px; overflow: hidden; margin-top: 5px; }
        .wallet-bar-fill { background: var(--gold); height: 100%; width: 0%; transition: 1s; box-shadow: 0 0 10px var(--gold); }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª */
        #admin-panel { display: none; width: 100%; max-width: 420px; background: #200; border: 2px solid #f00; border-radius: 20px; padding: 15px; margin-top: 15px; }
        .admin-row { font-size: 11px; padding: 5px; border-bottom: 1px solid #400; display: flex; justify-content: space-between; align-items: center; }
        .btn-cancel { background: #f00; color: #fff; border: none; padding: 3px 8px; border-radius: 5px; cursor: pointer; }

        .site-footer { width: 100%; max-width: 420px; background: rgba(10, 10, 10, 0.95); border: 1px solid rgba(226, 176, 74, 0.3); border-radius: 25px; padding: 25px 15px; margin-top: 25px; text-align: center; }
        .footer-logo-small { width: 50px; height: 50px; border-radius: 50%; border: 1px solid var(--gold); margin-bottom: 10px; }
        .footer-text { font-size: 13px; color: #bbb; line-height: 1.7; text-align: justify; }
        .footer-info-list { list-style: none; font-size: 13px; color: #ddd; margin-top: 10px; }
        .call-float { position: fixed; bottom: 20px; right: 20px; background: var(--gold); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; font-size: 28px; z-index: 1000; }
    </style>
</head>
<body>

    <div id="pwa-install-banner">
        <div class="banner-content">
            <img src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/8f6dcedf3dc3dbaa82c0df548bd962c9.jpg" class="banner-logo">
            <div class="banner-text"><b>Ù†ØµØ¨ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø§Ù„Ùˆ Ø°ØºØ§Ù„</b><br>Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø³Ø±ÛŒØ¹ Ùˆ Ø±Ø§Ø­Øª</div>
            <button class="btn-install-now" id="installBtn">Ù†ØµØ¨</button>
        </div>
    </div>

    <div class="header-section">
        <img src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/8f6dcedf3dc3dbaa82c0df548bd962c9.jpg" class="main-logo">
        <div class="brand-container"><span class="fire-anim">ğŸ”¥</span><div class="brand-name">Ø§Ù„Ùˆ Ø°ØºØ§Ù„</div><span class="fire-anim">ğŸ”¥</span></div>
        <div class="sub-brand">Ø³ÙØ§Ø±Ø´ Ø³Ø±ÛŒØ¹ Ø°ØºØ§Ù„</div>
    </div>

    <div class="media-container">
        <div class="video-slider">
            <button class="mute-toggle" onclick="toggleMute()"><span id="muteIcon">ğŸ”‡</span></button>
            <button class="nav-btn prev-btn" onclick="moveVideoSlide(-1)">â®</button>
            <button class="nav-btn next-btn" onclick="moveVideoSlide(1)">â¯</button>
            <div class="video-wrapper" id="videoWrapper">
                <video muted playsinline loop><source src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/a8c2f66bea9ea321326456dd5d058f26_720w.mp4" type="video/mp4"></video>
                <video muted playsinline loop><source src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/VID_20251227_172500_130.mp4" type="video/mp4"></video>
                <video muted playsinline loop><source src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/VID_20251227_172447_155.mp4" type="video/mp4"></video>
                <video muted playsinline loop><source src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/VID_20251227_172436_806.mp4" type="video/mp4"></video>
                <video muted playsinline loop><source src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/VID_20251227_172430_170.mp4" type="video/mp4"></video>
                <video muted playsinline loop><source src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/VID_20251227_172407_619.mp4" type="video/mp4"></video>
            </div>
        </div>
        <div class="image-fader" id="imgFader">
            <img src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/fa9760cb699d50f589f54d7ceb504aea.jpg" class="active">
            <img src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/b0e3ef2df45f5efe02e183abb11f6d2c.jpg">
            <img src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/ace2a27b61a4197c224de5881042326d.jpg">
            <img src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/2e3b9282f870ecf847697d6e3ff07a58.jpg">
            <img src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/122d58031851cec0be5ae6c33c1ae4e7.jpg">
        </div>
    </div>

    <div class="reviews-container"><div id="comment-content">Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ† Ù†Ø¸Ø±Ø§Øª...</div></div>

    <div class="order-card">
        <div id="form-area">
            <div class="form-group"><label>ğŸ‘¤ Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ:</label><input type="text" id="custName" oninput="checkAdminAuth()" placeholder="Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."></div>
            <div class="form-group">
                <label>ğŸ“ Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³:</label>
                <input type="tel" id="custPhone" placeholder="Û°Û¹..." maxlength="11" oninput="this.value = this.value.replace(/[^0-9]/g, ''); checkLoyalty(this.value); checkAdminAuth();" style="text-align: left; direction: ltr;">
                
                <div id="wallet-container" class="wallet-container" style="display:none; margin-top:10px;">
                    <span id="loyalty-status" class="loyalty-info"></span>
                    <div class="wallet-bar-bg"><div id="wallet-bar" class="wallet-bar-fill"></div></div>
                </div>
            </div>
            
            <button id="adminBtn" class="btn" style="display:none; background: #6a0dad; color:#fff;" onclick="toggleAdminPanel()">âš™ï¸ ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</button>

            <div id="admin-panel">
                <h4 style="color:#f00; margin-bottom:10px;">Ù…Ø¯ÛŒØ±ÛŒØª Ø³ÙØ§Ø±Ø´Ø§Øª (Ú©Ù†Ø³Ù„ÛŒ)</h4>
                <div id="admin-list" style="max-height:150px; overflow-y:auto; margin-bottom:15px;">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
                
                <h4 style="color:var(--gold); border-top:1px solid #444; padding-top:10px; margin-bottom:10px;">Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø¸Ø±Ø§Øª (Ø­Ø°Ù)</h4>
                <div id="admin-reviews-list" style="max-height:150px; overflow-y:auto;">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
            </div>

            <div class="form-group"><label>ğŸ•’ Ø²Ù…Ø§Ù† ØªØ­ÙˆÛŒÙ„:</label>
                <select id="delivTime">
                    <option value="ÙÙˆØ±ÛŒ">ÙÙˆØ±ÛŒ</option>
                    <option value="Û± Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡">Û± Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡</option>
                    <option value="Û² Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡">Û² Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡</option>
                    <option value="Û³ Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡">Û³ Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡</option>
                    <option value="Û´ Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡">Û´ Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡</option>
                    <option value="Ûµ Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡">Ûµ Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ù‡</option>
                </select>
            </div>
            <div class="form-group"><label>ğŸ  Ø¢Ø¯Ø±Ø³ Ù…Ø­Ù„Ù‡/Ú©ÙˆÚ†Ù‡:</label><textarea id="custAddr" rows="2" placeholder="Ø¢Ø¯Ø±Ø³ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒÚ©"></textarea></div>
            
            <div class="form-group"><label>ğŸ”¢ ØªØ¹Ø¯Ø§Ø¯ Ú©ÛŒØ³Ù‡ Ø°ØºØ§Ù„ (Û¶Ûµ,Û°Û°Û° Øª):</label>
                <div class="qty-box">
                    <button class="qty-btn" onclick="updateQty('zoghal', 1)">+</button>
                    <span id="qty-zoghal" style="font-size: 22px; font-weight: bold;">Û±</span>
                    <button class="qty-btn" onclick="updateQty('zoghal', -1)">-</button>
                </div>
            </div>

            <div class="form-group"><label>ğŸ¥— ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø³ØªÙ‡ Ø³Ø¨Ø²ÛŒ (Û³Ûµ,Û°Û°Û° Øª):</label>
                <div class="qty-box">
                    <button class="qty-btn" onclick="updateQty('sabzi', 1)">+</button>
                    <span id="qty-sabzi" style="font-size: 22px; font-weight: bold;">Û°</span>
                    <button class="qty-btn" onclick="updateQty('sabzi', -1)">-</button>
                </div>
            </div>

            <button class="btn btn-gps" id="gpsBtn" onclick="getLocation()">ğŸ“ Ø«Ø¨Øª Ù„ÙˆÚ©ÛŒØ´Ù† (GPS)</button>
            <button class="btn btn-gold" onclick="generateInvoice()">âœ¨ Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÙØ§Ú©ØªÙˆØ± Ù†Ù‡Ø§ÛŒÛŒ</button>

            <a href="https://aloozoghal-hash.github.io/-Mir-mir-/" class="challenge-link">
                ğŸ’¥Ú†Ø§Ù„Ø´ Ø±Ùˆ Ø¨Ø¨Ø±  Û³ Ú©ÛŒØ³Ù‡ Ø°ØºØ§Ù„ Ø¬Ø§ÛŒØ²Ù‡ Ø¨Ú¯ÛŒØ±ğŸ’¥
            </a>
            
            <button class="btn-share-modern" onclick="shareApp()">
                <div class="share-dot"></div>
                ğŸ“¤ Ø§Ø´ØªØ±Ø§Ú© Ùˆ Ù…Ø¹Ø±ÙÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¨Ù‡ Ø¯ÛŒÚ¯Ø±Ø§Ù†
            </button>
        </div>

        <div id="invoice" class="invoice-card">
            <h3 style="color:var(--gold); margin-bottom:10px;">ğŸ“‘ Ø³ÙØ§Ø±Ø´ Ù†Ù‡Ø§ÛŒÛŒ</h3>
            <div class="invoice-row"><span>Ø³ÙØ§Ø±Ø´ Ù…Ù†:</span> <b id="inv-name"></b></div>
            <div class="invoice-row"><span>ØªÙ„ÙÙ†:</span> <b id="inv-phone"></b></div>
            <div class="invoice-row" id="row-inv-zoghal"><span>Ø°ØºØ§Ù„:</span> <b id="inv-qty-zoghal"></b> Ú©ÛŒØ³Ù‡</div>
            <div class="invoice-row" id="row-inv-sabzi"><span>Ø³Ø¨Ø²ÛŒ:</span> <b id="inv-qty-sabzi"></b> Ø¨Ø³ØªÙ‡</div>
            <div class="invoice-row"><span>Ø²Ù…Ø§Ù†:</span> <b id="inv-time"></b></div>
            <div id="loyalty-discount-row" class="invoice-row" style="display:none; color: #00ff00;"><span>ØªØ®ÙÛŒÙ ÙˆÙØ§Ø¯Ø§Ø±ÛŒ (Ø®Ø±ÛŒØ¯ Û±Û°):</span> <b>Û³Û²,ÛµÛ°Û°- Øª</b></div>
            <div class="invoice-row"><span>Ù…Ø¨Ù„Øº Ú©Ù„:</span> <span><b id="inv-price"></b> ØªÙˆÙ…Ø§Ù†</span></div>
            
            <div style="margin-top:15px; display:flex; flex-direction:column; gap:8px;">
                <button id="tgBtn" onclick="sendToTelegram()" class="btn btn-tg" style="margin:0; display:block; background: linear-gradient(45deg, #0088cc, #005588);">â³ï¸ Ø«Ø¨Øª Ø³Ø±ÛŒØ¹ Ùˆ Ø¯Ø± Ù„Ø­Ø¸Ù‡</button>
                <a id="waLink" href="#" class="btn btn-wa" style="margin:0; display:block;">ğŸ“± Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ø§Ù„Ùˆ Ø°ØºØ§Ù„</a>
                <a id="smsLink" href="#" class="btn btn-sms" style="margin:0; display:block;">âœ‰ï¸ Ø§Ø±Ø³Ø§Ù„ Ø¨Ø§ Ù¾ÛŒØ§Ù…Ú© (SMS)</a>
                <div class="btn-action">
                    <button class="btn btn-edit" onclick="editOrder()">Ø§ØµÙ„Ø§Ø­</button>
                    <button class="btn btn-reset" onclick="resetForm()">Ø³ÙØ§Ø±Ø´ Ù…Ø¬Ø¯Ø¯</button>
                </div>
            </div>
        </div>
    </div>

    <div style="width:100%; max-width:420px; background:rgba(226,176,74,0.05); padding:20px; border-radius:25px; border:1px solid var(--gold); margin-top:25px;">
        <h4 style="text-align:center; color:var(--gold); margin-bottom:15px;"> Ø«Ø¨Øª Ø§Ù…ØªÛŒØ§Ø² Ùˆ Ù†Ø¸Ø± </h4>
        <div class="stars" id="star-rating">
            <span class="star active" data-v="5">â˜…</span><span class="star active" data-v="4">â˜…</span><span class="star active" data-v="3">â˜…</span><span class="star active" data-v="2">â˜…</span><span class="star active" data-v="1">â˜…</span>
        </div>
        <div class="form-group"><input type="text" id="revName" placeholder="Ù†Ø§Ù… Ø´Ù…Ø§"></div>
        <div class="form-group"><textarea id="revText" rows="2" placeholder="ØªØ¬Ø±Ø¨Ù‡ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§..."></textarea></div>
        <button class="btn btn-gold" id="sendRevBtn" onclick="sendReview()">Ø«Ø¨Øª Ù†Ø¸Ø± Ø¯Ø± Ù„ÛŒØ³Øª</button>
        <div id="dynamic-reviews-list" style="margin-top:20px;"></div>
    </div>

    <footer class="site-footer">
        <img src="https://raw.githubusercontent.com/aloozoghal-hash/alozoghal/main/8f6dcedf3dc3dbaa82c0df548bd962c9.jpg" class="footer-logo-small">
        <div style="color:var(--gold); font-weight:bold; margin-bottom:1px;">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø§Ù„Ùˆ Ø°ØºØ§Ù„</div>
        <p class="footer-text">Ø§Ù„Ùˆ Ø°ØºØ§Ù„ Ø§Ø² Ø¯Ù„ Ø§ÛŒØ°Ù‡ Ø¨Ø±Ø§ÛŒ Ø³ÙØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§ØµÙØ§ÛŒ Ø´Ù…Ø§. Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ø§ ÛŒÚ© Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´ Ø¯Ù‡ÛŒØ¯ ØªØ§ Ø¯Ø± Ø®Ø±ÛŒØ¯ Ø¯Ù‡Ù… Ø§Ø² ØªØ®ÙÛŒÙ ÙˆÛŒÚ˜Ù‡ Ø¨Ø±Ø®ÙˆØ±Ø¯Ø§Ø± Ø´ÙˆÛŒØ¯.</p>
        <ul class="footer-info-list">
            <li>ğŸ“ Ø¢Ø¯Ø±Ø³: Ø§ÛŒØ°Ù‡ØŒ Ù¾Ø§Ø±Ú© Ù„Ø§Ù„Ù‡</li>
        </ul>
    </footer>

    <a href="tel:09220730628" class="call-float">ğŸ“</a>

    <script>
        const GOOGLE_BRIDGE_URL = "https://script.google.com/macros/s/AKfycbyLQjEqmjs5Re2m7nf3lGU_IZQU0ILuFgiJWxrEQ306AgUy1zW090quuwv1QLWVOQyV/exec";
        const SHEET_API = "https://sheetdb.io/api/v1/4yb79n3j2hbvi";
        const OWNER_PHONE = "09220730628";

        let dynamicComments = []; 
        let cIdx = 0;
        let userPrevTotalCarts = 0;

        fetchReviews();

        function checkAdminAuth() {
            const name = document.getElementById('custName').value.trim();
            const phone = document.getElementById('custPhone').value.trim();
            const adminBtn = document.getElementById('adminBtn');
            if(name === "Ø¹Ù„ÛŒ Ù†Ø§Ø¯Ø±ÛŒ" && phone === "0937000000") {
                adminBtn.style.display = 'block';
            } else {
                adminBtn.style.display = 'none';
                document.getElementById('admin-panel').style.display = 'none';
            }
        }

        async function toggleAdminPanel() {
            const panel = document.getElementById('admin-panel');
            if(panel.style.display === 'block') { panel.style.display = 'none'; return; }
            panel.style.display = 'block';
            fetchAdminData();
        }

        async function fetchAdminData() {
            const listDiv = document.getElementById('admin-list');
            const reviewDiv = document.getElementById('admin-reviews-list');
            listDiv.innerText = "Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª...";
            reviewDiv.innerText = "Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª...";
            try {
                const res = await fetch(SHEET_API);
                const data = await res.json();
                
                // Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§Øª Ø¨Ø±Ø§ÛŒ Ú©Ù†Ø³Ù„ÛŒ
                listDiv.innerHTML = "";
                data.filter(i => i.comment.includes("Ø«Ø¨Øª Ø³ÛŒØ³ØªÙ…ÛŒ")).slice(-15).reverse().forEach(item => {
                    const row = document.createElement('div');
                    row.className = 'admin-row';
                    row.innerHTML = `<span>${item.name} (${item.comment.split('|')[0]})</span> <button class="btn-cancel" onclick="cancelOrder('${item.name}','${item.comment}')">Ú©Ù†Ø³Ù„</button>`;
                    listDiv.appendChild(row);
                });

                // Ù„ÛŒØ³Øª Ù†Ø¸Ø±Ø§Øª Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù
                reviewDiv.innerHTML = "";
                data.filter(i => !i.comment.includes("Ø«Ø¨Øª Ø³ÛŒØ³ØªÙ…ÛŒ")).slice(-15).reverse().forEach(item => {
                    const row = document.createElement('div');
                    row.className = 'admin-row';
                    row.innerHTML = `<span>${item.name}: ${item.comment.substring(0,15)}...</span> <button class="btn-cancel" onclick="deleteComment('${item.name}','${item.comment}')">Ø­Ø°Ù</button>`;
                    reviewDiv.appendChild(row);
                });

            } catch(e) { listDiv.innerText = "Ø®Ø·Ø§"; reviewDiv.innerText = "Ø®Ø·Ø§"; }
        }

        async function cancelOrder(name, comment) {
            if(!confirm("Ø¢ÛŒØ§ Ø§ÛŒÙ† Ø³ÙØ§Ø±Ø´ Ù„ØºÙˆ Ø´ÙˆØ¯ØŸ (Ø§Ø² Ù‚Ù„Ú© Ú©Ø³Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯)")) return;
            try {
                await fetch(`${SHEET_API}/comment/${encodeURIComponent(comment)}`, {
                    method: 'DELETE',
                    headers: {'Content-Type': 'application/json'}
                });
                alert("Ø³ÙØ§Ø±Ø´ Ù„ØºÙˆ Ø´Ø¯.");
                fetchAdminData();
            } catch(e) { alert("Ø®Ø·Ø§ Ø¯Ø± Ø­Ø°Ù"); }
        }

        async function deleteComment(name, comment) {
            if(!confirm("Ø¢ÛŒØ§ Ø§ÛŒÙ† Ù†Ø¸Ø± Ø­Ø°Ù Ø´ÙˆØ¯ØŸ")) return;
            try {
                await fetch(`${SHEET_API}/comment/${encodeURIComponent(comment)}`, {
                    method: 'DELETE',
                    headers: {'Content-Type': 'application/json'}
                });
                alert("Ù†Ø¸Ø± Ø­Ø°Ù Ø´Ø¯.");
                fetchAdminData();
            } catch(e) { alert("Ø®Ø·Ø§ Ø¯Ø± Ø­Ø°Ù"); }
        }

        async function checkLoyalty(phone) {
            const walletBox = document.getElementById('wallet-container');
            const statusLabel = document.getElementById('loyalty-status');
            const walletBar = document.getElementById('wallet-bar');

            if(phone.length === 11) {
                walletBox.style.display = 'block';
                statusLabel.innerText = "â³ Ø¨Ø±Ø±Ø³ÛŒ Ù‚Ù„Ú©...";
                try {
                    const res = await fetch(SHEET_API);
                    const data = await res.json();
                    
                    userPrevTotalCarts = data.reduce((total, item) => {
                        if(item.comment && item.comment.includes(phone) && item.comment.includes("Ø«Ø¨Øª Ø³ÛŒØ³ØªÙ…ÛŒ")) {
                            const match = item.comment.match(/ğŸ“¦ Ø°ØºØ§Ù„: (\d+)/);
                            return total + (match ? parseInt(match[1]) : 0);
                        }
                        return total;
                    }, 0);

                    const currentCycle = userPrevTotalCarts % 10;
                    const progress = currentCycle * 10;
                    walletBar.style.width = progress + "%";

                    if(userPrevTotalCarts > 0) {
                        if(currentCycle === 0 && userPrevTotalCarts >= 10) {
                            statusLabel.innerHTML = `âœ¨ ØªØ¨Ø±ÛŒÚ©! Ø®Ø±ÛŒØ¯ Ø¯Ù‡Ù… Ø´Ù…Ø§Ø³Øª. **Ù†ÛŒÙ…â€ŒØ¨Ù‡Ø§** Ø­Ø³Ø§Ø¨ Ù…ÛŒâ€ŒØ´ÙˆØ¯!`;
                        } else {
                            statusLabel.innerText = `Ø³Ø§Ø¨Ù‚Ù‡: ${userPrevTotalCarts} Ú©ÛŒØ³Ù‡ | ${10 - currentCycle} Ú©ÛŒØ³Ù‡ ØªØ§ Ù‡Ø¯ÛŒÙ‡ Ø¨Ø¹Ø¯ÛŒ.`;
                        }
                    } else {
                        statusLabel.innerText = "ğŸŒŸ Ø§ÙˆÙ„ÛŒÙ† Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§Ø³ØªØŸ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!";
                    }
                } catch(e) { statusLabel.innerText = ""; }
            } else {
                walletBox.style.display = 'none';
            }
        }

        async function fetchReviews() {
            try {
                const res = await fetch(SHEET_API);
                const data = await res.json();
                dynamicComments = data
                    .filter(item => !item.comment.includes("Ø«Ø¨Øª Ø³ÛŒØ³ØªÙ…ÛŒ"))
                    .map(item => {
                        const starsCount = parseInt(item.comment.match(/\((\d) Ø³ØªØ§Ø±Ù‡\)/)?.[1]) || 5;
                        const cleanText = item.comment.replace(/\(\d Ø³ØªØ§Ø±Ù‡\)\s*/, '');
                        return { n: item.name, t: cleanText, s: "â˜…".repeat(starsCount) };
                    }).reverse();
                
                const list = document.getElementById('dynamic-reviews-list');
                if(list) {
                    list.innerHTML = '<h5 style="margin-bottom:10px; color:var(--gold);">ğŸ’¬ Ù†Ø¸Ø±Ø§Øª Ù…Ø´ØªØ±ÛŒØ§Ù†:</h5>';
                    dynamicComments.slice(0, 10).forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'review-item';
                        div.innerHTML = `
                            <div style="display:flex; justify-content:space-between; align-items:center; font-size:11px;">
                                <b style="color:var(--gold)">${item.n} <span class="star-display">${item.s}</span></b>
                            </div>
                            <p style="font-size:12px; margin-top:5px;">${item.t}</p>`;
                        list.appendChild(div);
                    });
                }
                if(dynamicComments.length > 0 && !window.cycleStarted) {
                    startCycling();
                    window.cycleStarted = true;
                }
            } catch (e) {}
        }

        function startCycling() {
            const d = document.getElementById('comment-content');
            const showNext = () => {
                d.style.opacity = 0;
                setTimeout(() => {
                    if(dynamicComments.length){
                        const c = dynamicComments[cIdx % dynamicComments.length];
                        d.innerHTML = `<span class="c-name">${c.n}:</span>${c.t}<br><span style="color:var(--gold); letter-spacing:3px;">${c.s}</span>`;
                        d.style.opacity = 1;
                        cIdx++;
                    }
                }, 600);
            };
            showNext(); 
            setInterval(showNext, 5000);
        }

        let iIdx = 0; const imgs = document.querySelectorAll('#imgFader img');
        setInterval(() => { if(imgs.length) { imgs[iIdx].classList.remove('active'); iIdx = (iIdx + 1) % imgs.length; imgs[iIdx].classList.add('active'); } }, 3000);

        const videoWrapper = document.getElementById('videoWrapper');
        const vids = document.querySelectorAll('#videoWrapper video');
        let currentVidIdx = 0; let isMuted = true;
        
        function moveVideoSlide(direction) {
            vids[currentVidIdx].pause();
            currentVidIdx = (currentVidIdx + direction + vids.length) % vids.length;
            videoWrapper.style.transform = `translateX(${currentVidIdx * 100}%)`;
            playCurrentVideo();
        }
        function playCurrentVideo() { vids[currentVidIdx].muted = isMuted; vids[currentVidIdx].play().catch(e => {}); }
        function toggleMute() { isMuted = !isMuted; vids[currentVidIdx].muted = isMuted; document.getElementById('muteIcon').innerText = isMuted ? "ğŸ”‡" : "ğŸ”Š"; }

        let zCount = 1; let sCount = 0; let locL = "";
        function updateQty(type, v) {
            if(type === 'zoghal') { if(zCount + v >= 1) { zCount += v; document.getElementById('qty-zoghal').innerText = zCount; } }
            else { if(sCount + v >= 0) { sCount += v; document.getElementById('qty-sabzi').innerText = sCount; } }
        }
        function getLocation() {
            if(navigator.geolocation) {
                document.getElementById('gpsBtn').innerText="Ø¯Ø± Ø­Ø§Ù„ Ø«Ø¨Øª...";
                navigator.geolocation.getCurrentPosition(
                    p => {
                        locL = `https://www.google.com/maps?q=${p.coords.latitude},${p.coords.longitude}`;
                        document.getElementById('gpsBtn').innerText="âœ… Ù„ÙˆÚ©ÛŒØ´Ù† Ø«Ø¨Øª Ø´Ø¯";
                    },
                    err => {
                        document.getElementById('gpsBtn').innerText="ğŸ“ Ø«Ø¨Øª Ù„ÙˆÚ©ÛŒØ´Ù† (GPS)";
                        alert("âš ï¸ Ù„Ø·ÙØ§ Ù„ÙˆÚ©ÛŒØ´Ù† Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø±Ø§ Ø±ÙˆØ´Ù† Ú©Ù†ÛŒØ¯.");
                    },
                    { enableHighAccuracy: true, timeout: 10000 }
                );
            }
        }
        function editOrder() { document.getElementById('form-area').style.display='block'; document.getElementById('invoice').style.display='none'; }
        function resetForm() { location.reload(); }

        function generateInvoice() {
            const name = document.getElementById('custName').value.trim();
            const phone = document.getElementById('custPhone').value.trim();
            const addr = document.getElementById('custAddr').value.trim();
            const time = document.getElementById('delivTime').value;

            if(!name || phone.length < 11 || !addr) { alert("Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… Ù…ÙˆØ§Ø±Ø¯ Ø±Ø§ ØªÚ©Ù…ÛŒÙ„ Ú©Ù†ÛŒØ¯."); return; }

            let total = (zCount * 65000) + (sCount * 35000);
            
            const currentCycle = userPrevTotalCarts % 10;
            if(userPrevTotalCarts > 0 && currentCycle === 0) {
                total -= 32500;
                document.getElementById('loyalty-discount-row').style.display = 'flex';
            } else {
                document.getElementById('loyalty-discount-row').style.display = 'none';
            }

            document.getElementById('inv-name').innerText = name;
            document.getElementById('inv-phone').innerText = phone;
            document.getElementById('inv-qty-zoghal').innerText = zCount;
            document.getElementById('inv-qty-sabzi').innerText = sCount;
            document.getElementById('inv-time').innerText = time;
            document.getElementById('inv-price').innerText = total.toLocaleString();
            document.getElementById('row-inv-sabzi').style.display = sCount > 0 ? 'flex' : 'none';
            document.getElementById('form-area').style.display='none';
            document.getElementById('invoice').style.display='block';

            const msg = `ğŸ”¥ Ø³ÙØ§Ø±Ø´ Ø§Ù„Ùˆ Ø°ØºØ§Ù„ ğŸ”¥\nğŸ‘¤ Ù…Ø´ØªØ±ÛŒ: ${name}\nğŸ“ ØªÙ„ÙÙ†: ${phone}\nğŸ“¦ Ø°ØºØ§Ù„: ${zCount}\nğŸ¥— Ø³Ø¨Ø²ÛŒ: ${sCount}\nğŸ“Š Ú©Ù„ Ø®Ø±ÛŒØ¯Ù‡Ø§: ${userPrevTotalCarts + zCount}\nğŸ ÙˆØ¶Ø¹ÛŒØª Ù‡Ø¯ÛŒÙ‡: ${total < (zCount*65000) ? 'âœ… Ø§Ø¹Ù…Ø§Ù„ Ø´Ø¯' : 'âŒ Ù†Ø¯Ø§Ø±Ø¯'}\nğŸ•’ ØªØ­ÙˆÛŒÙ„: ${time}\nğŸ  Ø¢Ø¯Ø±Ø³: ${addr}\nğŸ’° Ù…Ø¨Ù„Øº: ${total.toLocaleString()} Øª\nğŸ“ Ù„ÙˆÚ©ÛŒØ´Ù†: ${locL || "Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡"}`;
            window.finalMsg = msg;
            
            document.getElementById('waLink').href = `https://wa.me/98${OWNER_PHONE.substring(1)}?text=${encodeURIComponent(msg)}`;
            document.getElementById('smsLink').href = `sms:${OWNER_PHONE}?body=${encodeURIComponent(msg)}`;
        }

        async function sendToTelegram() {
            const btn = document.getElementById('tgBtn'); 
            btn.disabled = true; 
            btn.innerText = "â³ Ø¯Ø± Ø­Ø§Ù„ Ø«Ø¨Øª...";

            const phone = document.getElementById('custPhone').value.trim();
            const name = document.getElementById('custName').value.trim();

            try {
                await fetch(SHEET_API, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ data: [{
                        name: name, 
                        comment: `ğŸ“¦ Ø°ØºØ§Ù„: ${zCount} | Ø´Ù…Ø§Ø±Ù‡: ${phone} | Ø«Ø¨Øª Ø³ÛŒØ³ØªÙ…ÛŒ`,
                        date: new Date().toLocaleDateString('fa-IR')
                    }] })
                });

                await fetch(GOOGLE_BRIDGE_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify({ message: window.finalMsg })
                });

                alert("âœ… Ø³ÙØ§Ø±Ø´ Ø«Ø¨Øª Ùˆ Ø³ÙˆØ§Ø¨Ù‚ Ø´Ù…Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.");
                location.reload();
            } catch (e) {
                alert("Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª. Ù„Ø·ÙØ§Ù‹ Ø§Ø² ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.");
                btn.disabled = false;
            }
        }

        let selectedRating = 5;
        document.querySelectorAll('.star').forEach(s => {
            s.onclick = function() {
                selectedRating = this.getAttribute('data-v');
                document.querySelectorAll('.star').forEach(x => {
                    x.classList.remove('active');
                    if(x.getAttribute('data-v') <= selectedRating) x.classList.add('active');
                });
            }
        });

        async function sendReview() {
            const n = document.getElementById('revName').value.trim();
            const t = document.getElementById('revText').value.trim();
            if(!n || !t) return alert("Ù†Ø§Ù… Ùˆ Ù†Ø¸Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯");
            const btn = document.getElementById('sendRevBtn');
            btn.innerText = "Ø¯Ø± Ø­Ø§Ù„ Ø«Ø¨Øª..."; btn.disabled = true;
            try {
                await fetch(SHEET_API, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ data: [{name: n, comment: `(${selectedRating} Ø³ØªØ§Ø±Ù‡) ${t}`, date: new Date().toLocaleDateString('fa-IR')}] })
                });
                alert("Ù†Ø¸Ø± Ø´Ù…Ø§ Ø«Ø¨Øª Ø´Ø¯!");
                location.reload(); 
            } catch (e) { alert("Ø®Ø·Ø§!"); }
            finally { btn.disabled = false; }
        }

        function shareApp() {
            if(navigator.share) navigator.share({ title: 'Ø§Ù„Ùˆ Ø°ØºØ§Ù„ Ø§ÛŒØ°Ù‡', url: window.location.href });
            else alert("Ù„ÛŒÙ†Ú© Ú©Ù¾ÛŒ Ø´Ø¯: " + window.location.href);
        }

        window.onload = () => { playCurrentVideo(); };
    </script>
</body>
</html>
